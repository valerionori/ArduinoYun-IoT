<!DOCTYPE html>
<html>
<title>Powder Plant Overview</title>
<link rel="icon" href="iot.png" type="image/png">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="w3.css">
<style>
body,h1,h2{font-family: "Raleway", sans-serif}
body, html {height: 100%}
p {line-height: 2}
.bgimg {
  min-height: 100%;
  background-position: center;
  background-size: cover;
}
.bgimg {background-image: url("wp3099773.jpg")}
</style>

<body>

<script type="text/javascript">
function SetLimit(Type, Lvalue){
	if(Type=="L1min"){
		document.getElementById("L1min").value=Lvalue;
    	document.getElementById("L1minset").innerHTML = 13 -Lvalue + " cm";
    }
	if(Type=="L2min"){
		document.getElementById("L2min").value=Lvalue;
    	document.getElementById("L2minset").innerHTML = 13 - Lvalue + " cm";
    }   
    
server="/arduino/conf/limit/" + Type + "/" + Lvalue;
request = new XMLHttpRequest();
request.open("GET", server, true);
request.send(null);
}

function SilosLevel(Type){

	server = "/arduino/param/" + Type;
	request = new XMLHttpRequest();
	request.responseType = 'text';
	request.onreadystatechange = function(){
		if(request.readyState == 4 && request.status == 200){
			if(Type == "l1"){
				var result = request.response;
              	document.getElementById("meter1").value = 12 - parseFloat(result);
				}
			if(Type == "l2"){
				var result = request.response;
				document.getElementById("meter2").value = 12 - parseFloat(result);
				}
		}
	}

	request.open("GET", server, true);
	request.send(null);
}

var tday=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
var tmonth=["January","February","March","April","May","June","July","August","September","October","November","December"];

function GetClock(){
var d=new Date();
var nday=d.getDay(),nmonth=d.getMonth(),ndate=d.getDate(),nyear=d.getFullYear();
var nhour=d.getHours(),nmin=d.getMinutes(),nsec=d.getSeconds();
if(nmin<=9) nmin="0"+nmin;
if(nsec<=9) nsec="0"+nsec;

var clocktext=""+tday[nday]+", "+tmonth[nmonth]+" "+ndate+", "+nyear+" "+nhour+":"+nmin+":"+nsec+"";
document.getElementById('clockbox').innerHTML=clocktext;
}
</script>

<!-- Header / Home-->
<header class="w3-display-container w3-wide bgimg w3-grayscale-min" id="home">
  <div class="w3-display-middle w3-text-black w3-center">
    <h1 class="w3-jumbo">Ceramics Process</h1>
    <h2><i>Powder Plant production site</i></h2>
    <h2><div id="clockbox"></div></h2>
    <script>
    GetClock();
	setInterval(GetClock,1000);
    </script>
  </div>
</header>

<!-- Navbar (sticky bottom) -->
<div class="w3-bottom w3-hide-small">
  <div class="w3-bar w3-white w3-center w3-padding w3-opacity-min w3-hover-opacity-off">
    <a href="#home" style="width:25%" class="w3-bar-item w3-button">Home</a>
    <a href="#levelsensors" style="width:25%" class="w3-bar-item w3-button">Silos Level</a>
    <a href="#control" style="width:25%" class="w3-bar-item w3-button">Control</a>
    <a href="#contact" style="width:25%" class="w3-bar-item w3-button w3-hover-black">Contact</a>
  </div>
</div>

<!-- Level Sensors -->
<div class="w3-container w3-padding-64 w3-pale-black w3-grayscale-min" id="levelsensors">
  <div class="w3-content">
    <h1 class="w3-center w3-text-grey"><b>Silos Level</b></h1>
    <p class="w3-wide">Silos 1 Level</p>
        <meter style="width: 700px; height: 80px" id="meter1" max="12" min="0" low="3" high="5" optimum="8" value="0"></meter>
	<p></p>
	<input class="w3-button w3-black w3-section" type="button" value="REFRESH" onclick="SilosLevel('l1')">
    <p class="w3-wide">Silos 2 Level</p>
	<meter style="width: 700px; height: 80px" id="meter2" max="12" min="0" low="3" high="5" optimum="8" value="0"></meter>
	<p></p>
	<input class="w3-button w3-black w3-section" type="button" value="REFRESH" onclick="SilosLevel('l2')">
  </div>
</div>

<!-- Control -->
<div class="w3-container w3-padding-64 w3-pale-black w3-grayscale-min" id="control">
  <div class="w3-content">
    <h1 class="w3-center w3-text-grey"><b>Control</b></h1>
    <p class="w3-wide">Silos 1 Minimun Level Trigger</p>
    <input style="width: 400px; height: 80px" id="L1min" min="6" max="10" type="range"
    value="1" step="0.1" onchange="SetLimit('L1min', this.value);">
    <span id="L1minset" value="1"></span>
    <p class="w3-wide">Silos 2 Minimun Level Trigger</p>
    <input style="width: 400px; height: 80px" id="L2min" min="6" max="10" type="range"
    value="1" step="0.1" onchange="SetLimit('L2min', this.value);">
    <span id="L2minset" value="1"></span>
    <p></p>
    <input class="w3-button w3-black w3-section" type="button" value="RESET MEASURAMENTS HISTORY" onclick="window.location.href='/arduino/param/resetHistory'">
        <input class="w3-button w3-black w3-section" type="button" value="RESET SILOS MINIMUM LEVEL" onclick="window.location.href='/arduino/param/resetStat'">
    <p></p>
    <p class="w3-wide">Configure Email Notification</p>
    <input class="w3-button w3-black w3-section" type="button" value="ENABLE" onclick="window.location.href='/arduino/conf/email/1'">
    <input class="w3-button w3-black w3-section" type="button" value="DISABLE" onclick="window.location.href='/arduino/conf/email/0'">
  </div>
</div>


  <!-- Contact Section -->
<div class="w3-container w3-padding-64 w3-pale-black w3-center w3-wide w3-grayscale-min" id="contact">
    <h1 class="w3-center w3-text-grey"><b>Notify the Laboratory</b></h1>
    <div class="w3-content">
    <form action="mailto:valerio.nori@hotmail.com" method="post">
      <input class="w3-input w3-border" type="text" placeholder="Operator" required name="Operator">
      <input class="w3-input w3-section w3-border" type="text" placeholder="Subject" required name="Subject">
      <button class="w3-button w3-black w3-section" type="submit">SEND MESSAGE
      </button>
    </form>
   </div> 
  </div>

<!-- Footer -->
<footer class="w3-center w3-black w3-padding-16">
  <p>Valerio Nori - University of Modena and Reggio Emilia - Master Degree in Electronics Engineering - Networking Technologies and Protocols - IoT Project - Academic Year 2020/2021</p>
</footer>
<div class="w3-hide-small" style="margin-bottom:32px"> </div>

</body>
</html>